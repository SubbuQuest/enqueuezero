<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Play around with Containers | Hands-On Cloud Native Application | Enqueue Zero</title>
    <meta name="description" content="Enqueue Zero is publishing code principles.">
    
    
    <link rel="preload" href="/assets/css/0.styles.c96f0afb.css" as="style"><link rel="preload" href="/assets/js/app.cf628e2c.js" as="script"><link rel="preload" href="/assets/js/72.9cd0ff48.js" as="script"><link rel="prefetch" href="/assets/js/10.6a56909d.js"><link rel="prefetch" href="/assets/js/100.a12fa14d.js"><link rel="prefetch" href="/assets/js/101.22ce2529.js"><link rel="prefetch" href="/assets/js/102.3edc023d.js"><link rel="prefetch" href="/assets/js/103.aae211b5.js"><link rel="prefetch" href="/assets/js/104.5729672b.js"><link rel="prefetch" href="/assets/js/105.de55b824.js"><link rel="prefetch" href="/assets/js/106.028c7731.js"><link rel="prefetch" href="/assets/js/107.613cefca.js"><link rel="prefetch" href="/assets/js/108.318e2864.js"><link rel="prefetch" href="/assets/js/109.1f37cebb.js"><link rel="prefetch" href="/assets/js/11.ee4e6e2c.js"><link rel="prefetch" href="/assets/js/110.eb9cb965.js"><link rel="prefetch" href="/assets/js/111.d80b2b17.js"><link rel="prefetch" href="/assets/js/112.6b4887be.js"><link rel="prefetch" href="/assets/js/113.2aaa51e0.js"><link rel="prefetch" href="/assets/js/114.643c3464.js"><link rel="prefetch" href="/assets/js/115.c021d926.js"><link rel="prefetch" href="/assets/js/116.1c342f7f.js"><link rel="prefetch" href="/assets/js/117.dadd54b8.js"><link rel="prefetch" href="/assets/js/118.ef47cff2.js"><link rel="prefetch" href="/assets/js/119.842e0bc9.js"><link rel="prefetch" href="/assets/js/12.b3e66443.js"><link rel="prefetch" href="/assets/js/120.54870231.js"><link rel="prefetch" href="/assets/js/121.d1871aa5.js"><link rel="prefetch" href="/assets/js/122.a3fa8c8a.js"><link rel="prefetch" href="/assets/js/123.17ef19fc.js"><link rel="prefetch" href="/assets/js/124.f98764e0.js"><link rel="prefetch" href="/assets/js/125.05b8f148.js"><link rel="prefetch" href="/assets/js/126.8e8cec71.js"><link rel="prefetch" href="/assets/js/127.8f073d6d.js"><link rel="prefetch" href="/assets/js/128.2c37220b.js"><link rel="prefetch" href="/assets/js/129.945fa4c7.js"><link rel="prefetch" href="/assets/js/13.ec29e50f.js"><link rel="prefetch" href="/assets/js/130.ac2d6f1f.js"><link rel="prefetch" href="/assets/js/131.980d7464.js"><link rel="prefetch" href="/assets/js/132.44a3afca.js"><link rel="prefetch" href="/assets/js/133.0333b205.js"><link rel="prefetch" href="/assets/js/134.90425b6c.js"><link rel="prefetch" href="/assets/js/135.df0c1677.js"><link rel="prefetch" href="/assets/js/136.65629541.js"><link rel="prefetch" href="/assets/js/137.a38aa087.js"><link rel="prefetch" href="/assets/js/138.c5615a2b.js"><link rel="prefetch" href="/assets/js/139.e340116c.js"><link rel="prefetch" href="/assets/js/14.5ddbc643.js"><link rel="prefetch" href="/assets/js/140.399bba23.js"><link rel="prefetch" href="/assets/js/141.661fc310.js"><link rel="prefetch" href="/assets/js/142.dcc59728.js"><link rel="prefetch" href="/assets/js/143.c86a462a.js"><link rel="prefetch" href="/assets/js/144.d576cca4.js"><link rel="prefetch" href="/assets/js/145.8d020e4c.js"><link rel="prefetch" href="/assets/js/146.e4d073cb.js"><link rel="prefetch" href="/assets/js/147.b0987282.js"><link rel="prefetch" href="/assets/js/148.fe093780.js"><link rel="prefetch" href="/assets/js/149.bb5f2be5.js"><link rel="prefetch" href="/assets/js/15.cb85b6fd.js"><link rel="prefetch" href="/assets/js/150.786218ee.js"><link rel="prefetch" href="/assets/js/151.778339ef.js"><link rel="prefetch" href="/assets/js/152.7417ae60.js"><link rel="prefetch" href="/assets/js/153.e9dbea0b.js"><link rel="prefetch" href="/assets/js/154.dc2b4de6.js"><link rel="prefetch" href="/assets/js/16.6a1e2274.js"><link rel="prefetch" href="/assets/js/17.fd36087a.js"><link rel="prefetch" href="/assets/js/18.168c46a3.js"><link rel="prefetch" href="/assets/js/19.f3e7fe90.js"><link rel="prefetch" href="/assets/js/2.8d365153.js"><link rel="prefetch" href="/assets/js/20.f0cfbb18.js"><link rel="prefetch" href="/assets/js/21.ad9f0c76.js"><link rel="prefetch" href="/assets/js/22.80066592.js"><link rel="prefetch" href="/assets/js/23.af4ba02e.js"><link rel="prefetch" href="/assets/js/24.fae8ace0.js"><link rel="prefetch" href="/assets/js/25.35cb6d5d.js"><link rel="prefetch" href="/assets/js/26.836800e5.js"><link rel="prefetch" href="/assets/js/27.37e59286.js"><link rel="prefetch" href="/assets/js/28.1cf5f9d2.js"><link rel="prefetch" href="/assets/js/29.958627af.js"><link rel="prefetch" href="/assets/js/3.a3fe37c5.js"><link rel="prefetch" href="/assets/js/30.78d39819.js"><link rel="prefetch" href="/assets/js/31.40989936.js"><link rel="prefetch" href="/assets/js/32.40ba7bf1.js"><link rel="prefetch" href="/assets/js/33.c269169e.js"><link rel="prefetch" href="/assets/js/34.6190fa21.js"><link rel="prefetch" href="/assets/js/35.997a2630.js"><link rel="prefetch" href="/assets/js/36.4a99c25c.js"><link rel="prefetch" href="/assets/js/37.95f1c818.js"><link rel="prefetch" href="/assets/js/38.08c40011.js"><link rel="prefetch" href="/assets/js/39.57a3c0d8.js"><link rel="prefetch" href="/assets/js/4.4f66e2d5.js"><link rel="prefetch" href="/assets/js/40.f11ff556.js"><link rel="prefetch" href="/assets/js/41.4b0e7fec.js"><link rel="prefetch" href="/assets/js/42.d9588bdb.js"><link rel="prefetch" href="/assets/js/43.da6e7c53.js"><link rel="prefetch" href="/assets/js/44.ffbb1244.js"><link rel="prefetch" href="/assets/js/45.8e1f9ad9.js"><link rel="prefetch" href="/assets/js/46.50186207.js"><link rel="prefetch" href="/assets/js/47.2faa306d.js"><link rel="prefetch" href="/assets/js/48.0590641a.js"><link rel="prefetch" href="/assets/js/49.5563663c.js"><link rel="prefetch" href="/assets/js/5.487c1af3.js"><link rel="prefetch" href="/assets/js/50.a22a98ff.js"><link rel="prefetch" href="/assets/js/51.9dc6d5d1.js"><link rel="prefetch" href="/assets/js/52.abf527a6.js"><link rel="prefetch" href="/assets/js/53.a6433fe5.js"><link rel="prefetch" href="/assets/js/54.f39dafb1.js"><link rel="prefetch" href="/assets/js/55.1e8902c2.js"><link rel="prefetch" href="/assets/js/56.49cb844b.js"><link rel="prefetch" href="/assets/js/57.73e5a82d.js"><link rel="prefetch" href="/assets/js/58.f1ca3ceb.js"><link rel="prefetch" href="/assets/js/59.d62e8fd3.js"><link rel="prefetch" href="/assets/js/6.21dcb9f2.js"><link rel="prefetch" href="/assets/js/60.60abc846.js"><link rel="prefetch" href="/assets/js/61.6409cbd4.js"><link rel="prefetch" href="/assets/js/62.3d696fc6.js"><link rel="prefetch" href="/assets/js/63.79a79167.js"><link rel="prefetch" href="/assets/js/64.5aa8065c.js"><link rel="prefetch" href="/assets/js/65.17ba2c01.js"><link rel="prefetch" href="/assets/js/66.a793dfd9.js"><link rel="prefetch" href="/assets/js/67.f4ce6970.js"><link rel="prefetch" href="/assets/js/68.71c36e8f.js"><link rel="prefetch" href="/assets/js/69.475d4399.js"><link rel="prefetch" href="/assets/js/7.ff15f4df.js"><link rel="prefetch" href="/assets/js/70.73a7ff67.js"><link rel="prefetch" href="/assets/js/71.aa1c61cd.js"><link rel="prefetch" href="/assets/js/73.e2af4058.js"><link rel="prefetch" href="/assets/js/74.04792ad8.js"><link rel="prefetch" href="/assets/js/75.0e66ae13.js"><link rel="prefetch" href="/assets/js/76.ec524056.js"><link rel="prefetch" href="/assets/js/77.c5dcea91.js"><link rel="prefetch" href="/assets/js/78.221a93b1.js"><link rel="prefetch" href="/assets/js/79.b1d0a709.js"><link rel="prefetch" href="/assets/js/8.0e400748.js"><link rel="prefetch" href="/assets/js/80.155f5152.js"><link rel="prefetch" href="/assets/js/81.c69f4948.js"><link rel="prefetch" href="/assets/js/82.41a3c9ca.js"><link rel="prefetch" href="/assets/js/83.968ea699.js"><link rel="prefetch" href="/assets/js/84.2ca53d4e.js"><link rel="prefetch" href="/assets/js/85.12ff3093.js"><link rel="prefetch" href="/assets/js/86.b77090c2.js"><link rel="prefetch" href="/assets/js/87.f9e0727b.js"><link rel="prefetch" href="/assets/js/88.6fa85a32.js"><link rel="prefetch" href="/assets/js/89.01cc619c.js"><link rel="prefetch" href="/assets/js/9.a52e4c8a.js"><link rel="prefetch" href="/assets/js/90.5211731d.js"><link rel="prefetch" href="/assets/js/91.52767f1b.js"><link rel="prefetch" href="/assets/js/92.6d373921.js"><link rel="prefetch" href="/assets/js/93.75608a6f.js"><link rel="prefetch" href="/assets/js/94.3ebc6dee.js"><link rel="prefetch" href="/assets/js/95.dfbacf62.js"><link rel="prefetch" href="/assets/js/96.6f9ccb49.js"><link rel="prefetch" href="/assets/js/97.8f06b6b0.js"><link rel="prefetch" href="/assets/js/98.50266cf3.js"><link rel="prefetch" href="/assets/js/99.2cf514ac.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c96f0afb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Enqueue Zero</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </div> <div class="page"> <div class="content"><h1 id="play-around-with-containers"><a href="#play-around-with-containers" aria-hidden="true" class="header-anchor">#</a> Play around with Containers</h1> <h2 id="what-is-container"><a href="#what-is-container" aria-hidden="true" class="header-anchor">#</a> What is Container?</h2> <h3 id="container-introduction"><a href="#container-introduction" aria-hidden="true" class="header-anchor">#</a> Container Introduction</h3> <p>A container is a set of processes just like other processes you launched from the shell, except that it's being isolated in its namespace, cgroups, and union filesystem. It has everything it needs in its isolation: code, runtime, system tools, system libraries, settings and so on. It is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another.</p> <h3 id="a-little-bit-background-visualization"><a href="#a-little-bit-background-visualization" aria-hidden="true" class="header-anchor">#</a> A Little Bit Background, Visualization</h3> <p>Before container era, we usually use visualization technology to limit and control system resources for the applications. However, it creates too much overhead on the physical machine. And thus, container as a lightweight solution emerged.</p> <h3 id="container-v-s-visualization"><a href="#container-v-s-visualization" aria-hidden="true" class="header-anchor">#</a> Container v/s Visualization</h3> <p>Containers and virtual machines have similar resource isolation and allocation benefits, but function differently because containers virtualize the operating system instead of hardware. Containers are more portable and efficient.</p> <h2 id="why-use-container"><a href="#why-use-container" aria-hidden="true" class="header-anchor">#</a> Why use Container?</h2> <h3 id="physical-resources-isolation"><a href="#physical-resources-isolation" aria-hidden="true" class="header-anchor">#</a> Physical Resources Isolation</h3> <p>Container isolates physical resources such as CPU, memory, disk I/O and network from other containers.</p> <h3 id="kernel-resources-isolation"><a href="#kernel-resources-isolation" aria-hidden="true" class="header-anchor">#</a> Kernel Resources Isolation</h3> <p>Container isolates OS kernel resources such process id, mount points, user and group IDs from other containers.</p> <h3 id="eliminate-the-difference-between-environments"><a href="#eliminate-the-difference-between-environments" aria-hidden="true" class="header-anchor">#</a> Eliminate the Difference between Environments</h3> <p>Containers eliminates differences between development and staging environments and help reduce conflicts between teams running different software on the same infrastructure.</p> <h2 id="essential-knowledge"><a href="#essential-knowledge" aria-hidden="true" class="header-anchor">#</a> Essential Knowledge</h2> <h3 id="host-machine"><a href="#host-machine" aria-hidden="true" class="header-anchor">#</a> Host Machine</h3> <h3 id="cgroups"><a href="#cgroups" aria-hidden="true" class="header-anchor">#</a> CGroups</h3> <p>Cgroups is a Kernel feature that organizes processes into hierarchical groups to limit and monitor their system usage such as CPU, memory, disk, network and so on.</p> <h3 id="unshare"><a href="#unshare" aria-hidden="true" class="header-anchor">#</a> Unshare</h3> <p>Unshare is a utility running program with some namespaces unshared from a parent. We create a new PID namespace below.</p> <h3 id="namespace"><a href="#namespace" aria-hidden="true" class="header-anchor">#</a> Namespace</h3> <p>Namespace enables us having the same name for some global system resources. For example, A PID namespace empowers the process inside the namespace running with 1 as PID, which at the same time, init is running with 1 as PID in the regular namespace.</p> <h3 id="unionfs"><a href="#unionfs" aria-hidden="true" class="header-anchor">#</a> UnionFS</h3> <p>Union File System or UnionFS variants such as AUFS, btrfs, vfs, and devicemapper are the file system that used by most container engines. It allows files and directories of separate file systems overlaid one by one, forming a final single coherent file system.</p> <h3 id="oci"><a href="#oci" aria-hidden="true" class="header-anchor">#</a> OCI</h3> <p>The Open Container Initiative or OCI develops specifications for standards on Operating System process and application containers. It defines two specs: the Runtime Specification and the Image Specification.</p> <h3 id="image"><a href="#image" aria-hidden="true" class="header-anchor">#</a> Image</h3> <p>The image is a binary packaged with files and organized by layers. The container is a runtime instance of the image. You can have various containers for one image. The image v/s container is pretty much like the program v/s process.</p> <h3 id="volume"><a href="#volume" aria-hidden="true" class="header-anchor">#</a> Volume</h3> <h2 id="containerize-the-front-end-application"><a href="#containerize-the-front-end-application" aria-hidden="true" class="header-anchor">#</a> Containerize the Front-End Application</h2> <h3 id="run-busybox-container"><a href="#run-busybox-container" aria-hidden="true" class="header-anchor">#</a> Run Busybox Container</h3> <p>The command <code>docker container run</code> runs a container with a image called called <code>busybox</code> and runs <code>top</code> command in the container. The <code>-t</code> flag allocates a pseudo-TTY and the <code>-i</code> flag keeps the shell interactively. The <code>--rm</code> flag makes sure the container will be deleted after it's disposed.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker run --rm -i -t busybox <span class="token function">top</span>
Mem: 1647528K used, 399220K free, 864K shrd, 34672K buff, 1286272K cached
CPU:  <span class="token number">0.0</span>% usr  <span class="token number">5.2</span>% sys  <span class="token number">0.0</span>% nic <span class="token number">92.1</span>% idle  <span class="token number">2.6</span>% io  <span class="token number">0.0</span>% irq  <span class="token number">0.0</span>% sirq
Load average: <span class="token number">0.63</span> <span class="token number">0.17</span> <span class="token number">0.06</span> <span class="token number">2</span>/459 <span class="token number">6</span>
  PID  <span class="token environment constant">PPID</span> <span class="token environment constant">USER</span>     STAT   VSZ %VSZ CPU %CPU COMMAND
    <span class="token number">1</span>     <span class="token number">0</span> root     R     <span class="token number">1252</span>  <span class="token number">0.0</span>   <span class="token number">1</span>  <span class="token number">0.0</span> <span class="token function">top</span>
</code></pre></div><h3 id="inspect-container"><a href="#inspect-container" aria-hidden="true" class="header-anchor">#</a> Inspect Container</h3> <p>List all available containers, which includes the container we just created.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker <span class="token function">ps</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
f4b12842544a        busybox             <span class="token string">&quot;top&quot;</span>               <span class="token number">8</span> seconds ago       Up <span class="token number">7</span> seconds                            jolly_torvalds
</code></pre></div><p>Attach into the container with an <code>sh</code> command.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>~ % docker <span class="token builtin class-name">exec</span> -it jolly_torvalds <span class="token function">sh</span>
/ <span class="token comment">#</span>
</code></pre></div><p>The <code>top</code> command shows another process gets created.</p> <div class="language- extra-class"><pre class="language-text"><code>Mem: 1650400K used, 396348K free, 872K shrd, 34948K buff, 1286788K cached
CPU:  0.0% usr  0.1% sys  0.0% nic 99.7% idle  0.0% io  0.0% irq  0.0% sirq
Load average: 0.02 0.08 0.05 2/454 22
  PID  PPID USER     STAT   VSZ %VSZ CPU %CPU COMMAND
   15     0 root     S     1256  0.0   0  0.0 sh
    1     0 root     R     1252  0.0   3  0.0 top
</code></pre></div><h3 id="dockerfile"><a href="#dockerfile" aria-hidden="true" class="header-anchor">#</a> Dockerfile</h3> <div class="language- extra-class"><pre class="language-text"><code>FROM node:11.8.0 as build-stage

WORKDIR /app

COPY package.json /app

RUN npm install

COPY . /app

RUN ls . &amp;&amp; npm run build

FROM nginx:1.15.8

COPY --from=build-stage /app/build /usr/share/nginx/html
</code></pre></div><h3 id="build-our-first-image"><a href="#build-our-first-image" aria-hidden="true" class="header-anchor">#</a> Build Our First Image</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker build -f src/frontend/Dockerfile -t delicioushref-frontend:latest src/frontend
</code></pre></div><h3 id="run-front-end-container"><a href="#run-front-end-container" aria-hidden="true" class="header-anchor">#</a> Run Front-End Container</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker run --rm -p <span class="token number">8000</span>:80 delicioushref-frontend:latest
</code></pre></div><h3 id="clean-up"><a href="#clean-up" aria-hidden="true" class="header-anchor">#</a> Clean Up</h3> <h3 id="push-image-to-registry"><a href="#push-image-to-registry" aria-hidden="true" class="header-anchor">#</a> Push Image to Registry</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>$ docker push
</code></pre></div><h2 id="references"><a href="#references" aria-hidden="true" class="header-anchor">#</a> References</h2></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/soasme/enqueuezero/edit/master/hands-on-cloud-native/container.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.cf628e2c.js" defer></script><script src="/assets/js/72.9cd0ff48.js" defer></script>
  </body>
</html>
