(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{276:function(e,t,a){"use strict";a.r(t);var s=a(0),r=Object(s.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e._m(0),e._v(" "),a("p"),e._m(1),a("p"),e._v(" "),e._m(2),e._v(" "),a("p",[e._v("Concurrency means we could run multiple tasks upon single CPU core.")]),e._v(" "),a("p",[e._v("Multiprocess and multithreading are the two most popular ways of doing concurrency. It leverages Operating System's process and thread (lightweight process). The problem is that data sharing is a problem, especially in multithreading. We need to apply locks to the shared data.")]),e._v(" "),a("p",[e._v("The actor model is another concurrency technology.")]),e._v(" "),e._m(3),e._v(" "),a("p",[e._v("The actor is an isolated concurrent unit scheduled by the programming language.")]),e._v(" "),a("p",[e._v("It's far more lightweight than processes or threads, so you can have hundreds of thousands of actors running simultaneously.")]),e._v(" "),a("p",[e._v("Actors are isolated from each other, meaning no actor can access other actors' data in memory. Instead, if needed, they communicate with each other via message passing.")]),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),a("p",[e._v("In the telecom industry, we find heavy use of Erlang. The actor model makes the system more reliable. Below hello world example shows the two fundamental operators: send and receive.")]),e._v(" "),e._m(6),e._m(7),e._v(" "),a("p",[e._v("Akka is de facto actor model implementation in Java and Scala.")]),e._v(" "),a("p",[e._v("It has a similar operator like Erlang and Elixir. Check "),a("a",{attrs:{href:"https://developer.lightbend.com/guides/akka-quickstart-scala/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("Akka Quickstart with Scala"),a("OutboundLink")],1),e._v(" for Hello World example. It's a little bit complicated than elixir example above.")]),e._v(" "),e._m(8),e._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/cloudwu/skynet",target:"_blank",rel:"noopener noreferrer"}},[e._v("Skynet"),a("OutboundLink")],1),e._v(" is a lightweight C-implemented actor system.")]),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),a("p",[e._v("OS process or thread needs to have minimum a few megabytes memory in OS.")]),e._v(" "),a("p",[e._v("Actors are tiny in contrast. It varies from implementations, but it generally needs only a few hundreds of bytes. That's why it can have hundreds of thousands of actors when consuming 1GB memory.")]),e._v(" "),a("p",[e._v("An actor has very few data in its data structure:")]),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),a("p",[e._v("Every actor has a mailbox, just like a mailbox in front of every house. It's a FIFO message queue that stores message sending from other actors.")]),e._v(" "),a("p",[e._v("The sequence of messages delivered to a mailbox determines the code be synchronized. The actor reacts by the following Message and suspends when no new Message.")]),e._v(" "),a("p",[e._v("Generally, the mailbox is a lock-free queue. Check "),a("router-link",{attrs:{to:"./lock-free-queues.html"}},[e._v("Lock-Free Queues")]),e._v(" If you want to know more.")],1),e._v(" "),e._m(13),e._v(" "),a("p",[e._v("The schedule system schedules when to run an actor. As a developer, you wouldn't necessarily need to use schedule system generally.")]),e._v(" "),a("p",[e._v("The scheduling system has two major implementations:")]),e._v(" "),e._m(14),e._v(" "),e._m(15),e._v(" "),a("p",[e._v("Schedule system maintains two queues:")]),e._v(" "),e._m(16),e._v(" "),a("p",[e._v("Below is a possible set of rules:")]),e._v(" "),e._m(17),e._v(" "),a("p",[e._v("Note that at a specific moment, there is only one instruction of a Proc is running in single CPU core. On a multiple CPU core machine, VM can create various schedulers.")]),e._v(" "),e._m(18),e._v(" "),e._m(19),e._v(" "),e._m(20),e._v(" "),a("p",[e._v("The actor doesn't care where the message comes. It can be from another actor in the same process or from another process in another machine.")]),e._v(" "),a("p",[e._v("This feature combining let-it-crash philosophy makes actor a perfect solution to build a robust distributed system.")]),e._v(" "),e._m(21),e._v(" "),a("p",[e._v("The actor model is yet another concurrency solution. The benefit is lock-free. The downside is only a few tools or framework support it. Either way, if you're stuck at lock when doing concurrent programming, try actor model.")])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"actor-model"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#actor-model","aria-hidden":"true"}},[this._v("#")]),this._v(" Actor Model")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#context"}},[e._v("Context")])]),a("li",[a("a",{attrs:{href:"#introduction"}},[e._v("Introduction")])]),a("li",[a("a",{attrs:{href:"#solutions"}},[e._v("Solutions")]),a("ul",[a("li",[a("a",{attrs:{href:"#erlang-elixir"}},[e._v("Erlang, Elixir")])]),a("li",[a("a",{attrs:{href:"#akka"}},[e._v("Akka")])]),a("li",[a("a",{attrs:{href:"#skynet"}},[e._v("Skynet")])])])]),a("li",[a("a",{attrs:{href:"#patterns"}},[e._v("Patterns")]),a("ul",[a("li",[a("a",{attrs:{href:"#small-memory-footprint"}},[e._v("Small Memory Footprint")])]),a("li",[a("a",{attrs:{href:"#mailbox-and-message-passing"}},[e._v("Mailbox and Message Passing")])]),a("li",[a("a",{attrs:{href:"#schedule-system"}},[e._v("Schedule System")])]),a("li",[a("a",{attrs:{href:"#ready-queue-waiting-queue"}},[e._v("Ready Queue & Waiting Queue")])]),a("li",[a("a",{attrs:{href:"#let-it-crash"}},[e._v("Let it crash")])]),a("li",[a("a",{attrs:{href:"#distribution"}},[e._v("Distribution")])])])]),a("li",[a("a",{attrs:{href:"#conclusions"}},[e._v("Conclusions")])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"context"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#context","aria-hidden":"true"}},[this._v("#")]),this._v(" Context")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"introduction"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#introduction","aria-hidden":"true"}},[this._v("#")]),this._v(" Introduction")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"solutions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions","aria-hidden":"true"}},[this._v("#")]),this._v(" Solutions")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"erlang-elixir"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#erlang-elixir","aria-hidden":"true"}},[this._v("#")]),this._v(" Erlang, Elixir")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v('pid = spawn fn ->\n  receive do\n    {:hello, msg} -> IO.puts(msg)\n  end\nend\n\nsend pid, {:hello, "world"}\n')])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"akka"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#akka","aria-hidden":"true"}},[this._v("#")]),this._v(" Akka")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"skynet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#skynet","aria-hidden":"true"}},[this._v("#")]),this._v(" Skynet")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"patterns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#patterns","aria-hidden":"true"}},[this._v("#")]),this._v(" Patterns")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"small-memory-footprint"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#small-memory-footprint","aria-hidden":"true"}},[this._v("#")]),this._v(" Small Memory Footprint")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("State")]),this._v(" "),t("li",[this._v("Behaviour")]),this._v(" "),t("li",[this._v("Mailbox")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"mailbox-and-message-passing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mailbox-and-message-passing","aria-hidden":"true"}},[this._v("#")]),this._v(" Mailbox and Message Passing")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"schedule-system"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#schedule-system","aria-hidden":"true"}},[this._v("#")]),this._v(" Schedule System")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("Use underlying OS threads.")]),this._v(" "),t("li",[this._v("VM implement its micro-threads.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"ready-queue-waiting-queue"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ready-queue-waiting-queue","aria-hidden":"true"}},[this._v("#")]),this._v(" Ready Queue & Waiting Queue")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("code",[this._v("ready_queue")]),this._v(".")]),this._v(" "),t("li",[t("code",[this._v("waiting_queue")]),this._v(".")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",[a("li",[e._v("Scheduler picks the HEAD of "),a("code",[e._v("ready_queue")]),e._v(" to run inside VM for a given time slice.")]),e._v(" "),a("li",[e._v("Scheduler moves the head of "),a("code",[e._v("ready_queue")]),e._v(" to the END of "),a("code",[e._v("ready_queue")]),e._v(" if the Proc can't finish in a given time slice.")]),e._v(" "),a("li",[e._v("Scheduler moves the HEAD of "),a("code",[e._v("ready_queue")]),e._v(" to the END of "),a("code",[e._v("waiting_queue")]),e._v(" if "),a("code",[e._v("recv")]),e._v(" blocks the Proc.")]),e._v(" "),a("li",[e._v("Scheduler moves a Proc from "),a("code",[e._v("waiting_queue")]),e._v(" to "),a("code",[e._v("ready_queue")]),e._v(" if it receives a message or waiting for the timeout.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"let-it-crash"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#let-it-crash","aria-hidden":"true"}},[this._v("#")]),this._v(" Let it crash")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("An actor might crash, just like process might crash. "),t("code",[this._v("Let it crash")]),this._v(" is a philosophy of isolating bad actors from crashing but leaving all other actors running as usual. Usually, a supervisor watches all actors. If an actor crashed, then it will try to do something based on your configured strategy, for example, restarting the actor.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"distribution"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#distribution","aria-hidden":"true"}},[this._v("#")]),this._v(" Distribution")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"conclusions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#conclusions","aria-hidden":"true"}},[this._v("#")]),this._v(" Conclusions")])}],!1,null,null,null);t.default=r.exports}}]);