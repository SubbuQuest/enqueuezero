(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{217:function(e,t,i){"use strict";i.r(t);var n=i(0),r=Object(n.a)({},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[e._m(0),e._v(" "),i("p",[e._v("It’s a fundamental requirement that we need to run a command at a specific time.")]),e._v(" "),e._m(1),e._v(" "),i("p",[e._v("Periodical Scheduler schedules code to be executed periodically. It has below features:")]),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),i("p",[e._v("Crontab is a Unix utility that gets installed in almost every Unix / Linux distribution.")]),e._v(" "),e._m(5),e._v(" "),i("p",[e._v("Check the manual of "),i("a",{attrs:{href:"http://man7.org/linux/man-pages/man5/crontab.5.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("crontab"),i("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(6),e._v(" "),i("p",[e._v("Kubernetes Cron Job is like crontab file in my forms except that it runs in a Kubernetes cluster.")]),e._v(" "),e._m(7),e._v(" "),i("p",[e._v("Check the documentation of "),i("a",{attrs:{href:"https://kubernetes.io/docs/tasks/job/automated-tasks-with-cron-jobs/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Running Automated Tasks with a CronJob"),i("OutboundLink")],1),e._v(".")]),e._v(" "),e._m(8),e._v(" "),i("p",[e._v("Scheduler libraries let you schedule code to be executed later. Below are some typical implementations:")]),e._v(" "),e._m(9),e._v(" "),i("p",[e._v("The libraries are useful when you want to integrate scheduler into your application.")]),e._v(" "),e._m(10),e._v(" "),e._m(11),e._v(" "),e._m(12),e._v(" "),i("p",[e._v("Using crontab is the easiest way to schedule periodic jobs. The limitation is that you can’t control the resource usage and it’s less flexible. To run periodic jobs in a fine-controlled environment, you might want to choose Kubernetes CronJob. To leverage the power of periodic scheduler, you might want to integrate a scheduler library into your application.")])])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"context"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#context","aria-hidden":"true"}},[this._v("#")]),this._v(" Context")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"overview"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[this._v("#")]),this._v(" Overview")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("Job managing, meaning adding new jobs, removing old ones, or modifying existing ones.")]),this._v(" "),t("li",[this._v("Job storing.")]),this._v(" "),t("li",[this._v("Run as a long-running process.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"solutions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#solutions","aria-hidden":"true"}},[this._v("#")]),this._v(" Solutions")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"crontab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#crontab","aria-hidden":"true"}},[this._v("#")]),this._v(" Crontab")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[i("li",[e._v("You can run "),i("code",[e._v("crontab -e")]),e._v(" to edit jobs, which will prompt you an editor.\n"),i("ul",[i("li",[e._v("To remove jobs, you need to remove those lines defining jobs.")]),e._v(" "),i("li",[e._v("To add a new job, you will need to add a new line of definition in the form like "),i("code",[e._v("*/5 * * * * /opt/my-lib/bin/my-prog")]),e._v(". The first five fields are minute, hour, the day of a month, month, and the day of a week. The last field is the command.")])])]),e._v(" "),i("li",[e._v("In most Linux distros, per user crontab are typically stored in "),i("code",[e._v("/var/spool/cron/crontabs/{username}")]),e._v(".")]),e._v(" "),i("li",[e._v("The long-running process is a daemon called "),i("code",[e._v("crond")]),e._v(".")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"kubernetes-cronjob"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-cronjob","aria-hidden":"true"}},[this._v("#")]),this._v(" Kubernetes CronJob")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("To manage the Kubernetes CronJob, you need to write a YAML file and apply to the Kubernetes API Master.")]),this._v(" "),t("li",[this._v("Jobs are stored in Etcd.")]),this._v(" "),t("li",[this._v("The Kubernetes API Master does the scheduling work.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"scheduler-libraries"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#scheduler-libraries","aria-hidden":"true"}},[this._v("#")]),this._v(" Scheduler Libraries")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[i("li",[i("p",[e._v("APScheduler for Python")])]),e._v(" "),i("li",[i("p",[e._v("Whenever for Ruby")])]),e._v(" "),i("li",[i("p",[e._v("To manage the jobs, you usually need to call functions like "),i("code",[e._v("add_job")]),e._v(", "),i("code",[e._v("remove_job")]),e._v(", etc.")]),e._v(" "),i("ul",[i("li",[e._v("Some libraries enables you managing jobs at runtime. Some applications ships with a web UI to manage jobs.")])])]),e._v(" "),i("li",[i("p",[e._v("The definition of scheduler libraries varies but is generally flexible. It supports cron-style definition, and also an embed DSL for managing jobs. You might get a chance to define jobs in the form like "),i("code",[e._v("every 1.hour { run 'my job' }")]),e._v(".")])]),e._v(" "),i("li",[i("p",[e._v("The libraries generally need to run as a single process and managed by supervisor software.")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"patterns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#patterns","aria-hidden":"true"}},[this._v("#")]),this._v(" Patterns")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[i("li",[e._v("A single periodic job can create multiple instances. Therefore, to avoid duplicate running jobs, we need to ensure that the jobs are idempotent, meaning they can run several times without side-effect.")]),e._v(" "),i("li",[e._v("The periodic scheduler generally runs as a single instance.")]),e._v(" "),i("li",[e._v("The instances for a periodic job usually runs in a thread or process for isolation.")]),e._v(" "),i("li",[e._v("Limiting the number of concurrently executing instances is essential. If a task runs over the window, you need to decide if the scheduler needs to trigger the next job.")]),e._v(" "),i("li",[e._v("Sometimes the scheduler might miss triggering job executions. You need to determine whether the scheduler needs to trigger the missed job.")]),e._v(" "),i("li",[e._v("Logging for the scheduler is a bonus. It can help end users do troubleshooting.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"conclusions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#conclusions","aria-hidden":"true"}},[this._v("#")]),this._v(" Conclusions")])}],!1,null,null,null);t.default=r.exports}}]);